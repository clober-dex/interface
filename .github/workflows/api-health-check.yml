name: API Health Check

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  check-api:
    runs-on: ubuntu-latest

    steps:
      - name: Check base-tokens endpoint
        run: |
          STATUS=$(curl -o /dev/null -s -w "%{http_code}" "https://alpha.clober.io/api/chains/1/base-tokens/0x0000000000000000000000000000000000000000/quote-tokens/0x0000000000000000000000000000000000000000")
          if [ "$STATUS" -ne 200 ]; then
            echo "‚ùå base-tokens endpoint failed with status $STATUS"
            exit 1
          else
            echo "‚úÖ base-tokens OK ($STATUS)"
          fi

      - name: Check quote endpoint
        run: |
          STATUS=$(curl -o /dev/null -s -w "%{http_code}" "https://alpha.clober.io/api/chains/1/quote")
          if [ "$STATUS" -ne 200 ]; then
            echo "‚ùå quote endpoint failed with status $STATUS"
            exit 1
          else
            echo "‚úÖ quote OK ($STATUS)"
          fi

      - name: Check price endpoint
        run: |
          STATUS=$(curl -o /dev/null -s -w "%{http_code}" "https://alpha.clober.io/api/chains/1/price")
          if [ "$STATUS" -ne 200 ]; then
            echo "‚ùå price endpoint failed with status $STATUS"
            exit 1
          else
            echo "‚úÖ price OK ($STATUS)"
          fi

      - name: All checks passed
        run: echo "üéâ All API endpoints are healthy!"